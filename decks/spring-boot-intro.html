<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title></title>
	
	<meta name="description" content="A jQuery library for modern HTML presentations">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="../deck.js/core/deck.core.css">
	<link rel="stylesheet" href="../deck.js/extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="../deck.js/extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="../deck.js/extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="../deck.js/extensions/status/deck.status.css">
	<link rel="stylesheet" href="../deck.js/extensions/hash/deck.hash.css">
	<link rel="stylesheet" href="../css/syntax.css">
	
	<!-- Theme CSS files (menu swaps these out) -->
    <link rel="stylesheet" href="../font-awesome/css/font-awesome.css">
    
    
	<link rel="stylesheet" id="style-theme-link" href="../themes/style/spring.css">
	<link rel="stylesheet" id="transition-theme-link" href="../deck.js/themes/transition/horizontal-slide.css">
	
	<script src="../deck.js/modernizr.custom.js"></script>
</head>

<body class="deck-container">

<div class="slide" id="slide1"><h1 id="toc_0"><i class="icon-off"></i> Spring Boot</h1>

<p>Dave Syer, Phil Webb, 2013<br>
Twitter: <code>@david_syer</code>, <code>@phillip_webb</code><br>
Email: [dsyer, pwebb]@gopivotal.com</p>

<p>(Introduction to Spring Boot)</p>

</div><div class="slide" id="slide2"><h2></h2>

<p><img src="images/spring-io-boot.png" alt="Spring IO"></p>

</div><div class="slide" id="slide3"><h2 id="toc_1">Agenda</h2>

<ul>
<li>Quick overview of goals and high level features</li>
<li>Getting started demo</li>
<li>Application configuration with Spring Boot</li>
<li>Behind the scenes</li>
<li>Customization and extensions</li>
</ul>

</div><div class="slide" id="slide4"><h2 id="toc_2">Focus Attention</h2>

<p><img src="images/boot-focus.png" width="30%"></img></p>

</div><div class="slide" id="slide5"><h2 id="toc_3">Introduction</h2>

<p><i class="icon-off icon-3x"></i> Spring Boot:</p>

<ul>
<li>Single point of focus (as opposed to large collection
of <code>spring-*</code> projects)</li>
<li>A tool for getting started very quickly with Spring</li>
<li>Common non-functional requirements for a &quot;real&quot; application</li>
<li>Exposes a lot of useful features by default</li>
<li>Gets out of the way quickly if you want to change defaults</li>
</ul>

<blockquote>
<p>An opportunity for Spring to be opinionated</p>
</blockquote>

</div><div class="slide" id="slide6"><h2 id="toc_4">Installation</h2>

<ul>
<li>Requirements: Java (&gt;=1.6) + (for Java projects) Maven 3 or gradle &gt;=1.6</li>
<li>Download: <a href="http://repo.spring.io/milestone/org/springframework/boot/spring-boot-cli/0.5.0.M6/spring-boot-cli-0.5.0.M6-bin.zip">http://repo.spring.io/milestone/org/springframework/boot/spring-boot-cli/0.5.0.M6/spring-boot-cli-0.5.0.M6-bin.zip</a></li>
<li>Unzip the distro (approx. 10MB), and find <code>bin/</code> directory</li>
</ul>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$ spring --help
...
</code></pre></div>
<p>(Or follow instructions on
<a href="https://github.com/spring-projects/spring-boot">Github</a> for GVM or
Brew.)</p>

</div><div class="slide" id="slide7"><h2 id="toc_5">Getting Started <em>Really</em> Quickly</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div><div class="highlight"><pre><code class="text language-text" data-lang="text">$ spring run app.groovy
</code></pre></div>
<p><br/><br/>... application is running at <a href="http://localhost:8080">http://localhost:8080</a></p>

</div><div class="slide" id="slide8"><h2 id="toc_6">What Just Happened?</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="c1">// import org.springframework.web.bind.annotation.RestController</span>
<span class="c1">// other imports ...</span>

<span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide9"><h2 id="toc_7">What Just Happened?</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="c1">// import org.springframework.web.bind.annotation.RestController</span>
<span class="c1">// other imports ...</span>

<span class="c1">// @Grab(&quot;org.springframework.boot:spring-boot-web-starter:0.5.0&quot;)</span>
<span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide10"><h2 id="toc_8">What Just Happened?</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="c1">// import org.springframework.web.bind.annotation.RestController</span>
<span class="c1">// other imports ...</span>

<span class="c1">// @Grab(&quot;org.springframework.boot:spring-boot-web-starter:0.5.0&quot;)</span>
<span class="c1">// @EnableAutoConfiguration</span>
<span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide11"><h2 id="toc_9">What Just Happened?</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="c1">// import org.springframework.web.bind.annotation.RestController</span>
<span class="c1">// other imports ...</span>

<span class="c1">// @Grab(&quot;org.springframework.boot:spring-boot-web-starter:0.5.0&quot;)</span>
<span class="c1">// @EnableAutoConfiguration</span>
<span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="c1">//  public static void main(String[] args) {</span>
<span class="c1">//      SpringApplication.run(Example.class, args);</span>
<span class="c1">//  }</span>
<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide12"><h2 id="toc_10">Getting Started in Java</h2>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.*</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@EnableAutoConfiguration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApplication</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">MyApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
  <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide13"><h2 id="toc_11">What Just Happened?</h2>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@EnableAutoConfiguration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApplication</span> <span class="o">{</span>

  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">sayHello</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="o">...</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide14"><h2 id="toc_12">Starter POMs</h2>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<ul>
<li>Standard Maven POMs</li>
<li>Define dependencies that we recommend</li>
<li>Parent optional</li>
<li>Available for web, batch, integration, data, amqp, aop, jdbc, ...</li>
<li>e.g. data = hibernate + spring-data + JSR 303</li>
</ul>

</div><div class="slide" id="slide15"><h2 id="toc_13">SpringApplication</h2>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="n">SpringApplication</span> <span class="n">app</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SpringApplication</span><span class="o">(</span><span class="n">MyApplication</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">app</span><span class="o">.</span><span class="na">setShowBanner</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
<span class="n">app</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</code></pre></div>
<ul>
<li>Gets a running Spring <code>ApplicationContext</code></li>
<li>Uses <code>EmbeddedWebApplicationContext</code> for web apps</li>
<li>Can be a single line: <code>SpringApplication.run(MyApplication.class, args)</code></li>
<li>Or customized (see later)...</li>
</ul>

</div><div class="slide" id="slide16"><h2 id="toc_14">@EnableAutoConfiguration</h2>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="nd">@EnableAutoConfiguration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApplication</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>
<ul>
<li>Attempts to auto-configure your application</li>
<li>Backs off as you define your own beans</li>
<li>Regular <code>@Configuration</code> classes</li>
<li>Usually with <code>@ConditionalOnClass</code> and <code>@ConditionalOnMissingBean</code></li>
</ul>

</div><div class="slide" id="slide17"><h2 id="toc_15">Packaging For Production</h2>

<p>Maven plugin (using <code>spring-boot-starter-parent</code>):</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>mvn package
</code></pre></div>
<p>Gradle plugin:</p>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">&#39;spring-boot&#39;</span>
</code></pre></div><div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>gradle repackage
</code></pre></div>
</div><div class="slide" id="slide18"><h2 id="toc_16">Packaging For Production</h2>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>java -jar yourapp.jar
</code></pre></div>
<ul>
<li>Easy to understand structure</li>
<li>No unpacking or start scripts required</li>
<li>Typical REST app ~10Mb</li>
<li>Cloud Foundry friendly (works &amp; fast to upload)</li>
</ul>

</div><div class="slide" id="slide19"><h2 id="toc_17">Spring Boot Modules</h2>

<ul>
<li>Spring Boot - main library supporting the other parts of Spring Boot</li>
<li>Spring Boot Autoconfigure - single <code>@EnableAutoConfiguration</code>
annotation creates a whole Spring context</li>
<li>Spring Boot Starters - a set of convenient dependency descriptors
that you can include in your application.</li>
<li>Spring Boot CLI - compiles and runs Groovy source as a Spring
application</li>
<li>Spring Boot Actuator - common non-functional features that make an
app instantly deployable and supportable in production</li>
<li>Spring Boot Tools - for building and executing self-contained JAR
and WAR archives</li>
<li>Spring Boot Samples - a wide range of sample apps</li>
</ul>

</div><div class="slide" id="slide20"><h2 id="toc_18">Spring Boot Module Relations</h2>

<p><img src="images/boot-modules.png" alt="Spring Boot Modules"></p>

</div><div class="slide" id="slide21"><h2 id="toc_19">Not a Web Application?</h2>

<ul>
<li><code>CommandLineRunner</code> is a hook to run application-specific code after 
the context is created</li>
</ul>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Startup</span> <span class="kd">implements</span> <span class="n">CommandLineRunner</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Hello World&quot;</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide22"><h2 id="toc_20">SpringApplicationBuilder</h2>

<p>Flexible builder style with fluent API for building
<code>SpringApplication</code> with more complex requirements.</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="k">new</span> <span class="nf">SpringApplicationBuilder</span><span class="o">(</span><span class="n">ParentConfiguration</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">profiles</span><span class="o">(</span><span class="s">&quot;adminServer&quot;</span><span class="o">,</span> <span class="s">&quot;single&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">child</span><span class="o">(</span><span class="n">AdminServerApplication</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
</code></pre></div>
</div><div class="slide" id="slide23"><h2 id="toc_21">Environment and Profiles</h2>

<ul>
<li>Every <code>ApplicationContext</code> has an <code>Environment</code></li>
<li>Spring <code>Environment</code> available since 3.1</li>
<li>Abstraction for key/value pairs from multiple sources</li>
<li>Used to manage <code>@Profile</code> switching</li>
<li>Always available: <code>System</code> properties and OS <code>ENV</code> vars</li>
</ul>

</div><div class="slide" id="slide24"><h2 id="toc_22">Command Line Arguments</h2>

<ul>
<li><code>SpringApplication</code> adds command line arguments to the Spring 
<code>Environment</code> so you can refer inject them into beans:</li>
</ul>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@Value</span><span class="o">(</span><span class="s">&quot;${name}&quot;</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</code></pre></div><div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>java -jar yourapp.jar --name<span class="o">=</span>Dave
</code></pre></div>
<ul>
<li>You can also configure many aspects of Spring Boot itself:</li>
</ul>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>java -jar target/*.jar --server.port<span class="o">=</span>9000
</code></pre></div>
</div><div class="slide" id="slide25"><h2 id="toc_23">Externalizing Configuration to Properties</h2>

<p>Just put <code>application.properties</code> in your classpath or next to you jar, e.g.</p>

<p><code>application.properties</code></p>
<div class="highlight"><pre><code class="properties language-properties" data-lang="properties"><span class="na">server.port</span><span class="o">:</span> <span class="s">9000</span>
</code></pre></div>
<p>Properties can be overridden (<code>command line arg</code> &gt; <code>file</code> &gt; <code>classpath</code>)</p>

</div><div class="slide" id="slide26"><h2 id="toc_24">Using YAML</h2>

<p>Just include <code>snake-yaml.jar</code> and put <code>application.yml</code> in your classpath</p>

<p><code>application.yml</code></p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">server</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">9000</span>
</code></pre></div>
<p>Both properties and YAML add entries with period-separated paths to
the Spring <code>Environment</code>.</p>

</div><div class="slide" id="slide27"><h2 id="toc_25">Binding Configuration To Beans</h2>

<p><code>MyProperties.java</code></p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span><span class="o">=</span><span class="s">&quot;mine&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyPoperties</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Resource</span> <span class="n">location</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">skip</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="c1">// ... getters and setters</span>
<span class="o">}</span>
</code></pre></div>
<p><code>application.properties</code></p>
<div class="highlight"><pre><code class="properties language-properties" data-lang="properties"><span class="na">mine.location</span><span class="o">:</span> <span class="s">classpath:mine.xml</span>
<span class="na">mine.skip</span><span class="o">:</span> <span class="s">false</span>
</code></pre></div>
</div><div class="slide" id="slide28"><h2 id="toc_26">Data Binding to <code>@ConfigurationProperties</code></h2>

<ul>
<li>Spring <code>DataBinder</code> so does type coercion and conversion where possible</li>
<li>Custom <code>ConversionService</code> additionally discovered by bean name
(same as <code>ApplicationContext</code>)</li>
<li>Ditto for validation

<ul>
<li><code>configurationPropertiesValidator</code> bean if present</li>
<li>JSR303 if present</li>
<li><code>ignoreUnkownFields=true</code> (default)</li>
<li><code>ignoreInvalidFields=false</code> (default)</li>
</ul></li>
<li>Uses a <code>RelaxedDataBinder</code> which accepts common variants of property
names (e.g. <code>CAPITALIZED</code>, <code>camelCased</code> or <code>with_underscores</code>)</li>
</ul>

<blockquote>
<p>Also binds to <code>SpringApplication</code></p>
</blockquote>

</div><div class="slide" id="slide29"><h2 id="toc_27">Customizing Configuration Location</h2>

<p>Set </p>

<ul>
<li><code>spring.config.name</code> - default <code>application</code>, can be comma-separated
list</li>
<li><code>spring.config.location</code> - a <code>Resource</code> path, overrides name</li>
</ul>

<p>e.g.</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>java -jar target/*.jar --spring.config.name<span class="o">=</span>production
</code></pre></div>
</div><div class="slide" id="slide30"><h2 id="toc_28">Spring Profiles</h2>

<ul>
<li><p>Activate external configuration with a Spring profile</p>

<ul>
<li>file name convention e.g. <code>application-development.properties</code></li>
<li>or nested documents in YAML:</li>
</ul>

<p><code>application.yml</code></p>
<div class="highlight"><pre><code class="yaml language-yaml" data-lang="yaml"> <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">etc...</span>
 <span class="l-Scalar-Plain">---</span>
 <span class="l-Scalar-Plain">spring</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">profiles</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">development,postgresql</span>
 <span class="l-Scalar-Plain">other</span><span class="p-Indicator">:</span>
   <span class="l-Scalar-Plain">stuff</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">more stuff...</span>
</code></pre></div></li>
<li><p>Set the default spring profile in external configuration, e.g:</p>

<p><code>application.properties</code></p>
<div class="highlight"><pre><code class="properties language-properties" data-lang="properties"><span class="na">spring.profiles.active</span><span class="o">:</span> <span class="s">default, postgresql</span>
</code></pre></div></li>
</ul>

</div><div class="slide" id="slide31"><h2 id="toc_29">Logging</h2>

<ul>
<li>Spring Boot provides default configuration files for 3 common logging
frameworks: logback, log4j and <code>java.util.logging</code></li>
<li>Starters (and Samples) use logback with colour output</li>
<li>External configuration and classpath influence runtime behavior</li>
<li><code>LoggingApplicationContextInitializer</code> sets it all up</li>
</ul>

</div><div class="slide" id="slide32"><h2 id="toc_30">Adding some Autoconfigured Behavior</h2>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>spring-jdbc<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.hsqldb<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hsqldb<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<p>Extend the demo and see what we can get by just modifying the
classpath, e.g. </p>

<ul>
<li>Add an in memory database</li>
<li>Add a Tomcat connection pool</li>
</ul>

</div><div class="slide" id="slide33"><h2 id="toc_31">Adding Static Resources</h2>

<p>Easiest: use <code>classpath:/static/**</code></p>

<p>Many alternatives:</p>

<ul>
<li><code>classpath:/public/**</code></li>
<li><code>classpath:/resources/**</code></li>
<li><code>classpath:/META-INF/resources/**</code></li>
<li>Normal servlet context <code>/</code> (root of WAR file, see later)

<ul>
<li>i.e. <code>src/main/webapp</code> if building with Maven or Gradle</li>
<li><code>static/**</code></li>
<li><code>public/**</code></li>
<li>set <code>documentRoot</code> in <code>EmbeddedServletContextFactory</code> (see
later)</li>
</ul></li>
<li>Special treatment for <code>index.html</code> (in any of the above locations)</li>
</ul>

</div><div class="slide" id="slide34"><h2 id="toc_32">Adding A UI with Thymeleaf</h2>

<ul>
<li>Add Thymeleaf to the classpath and see it render a view</li>
<li>Spring Boot Autoconfigure adds all the boilerplate stuff</li>
<li>Common configuration options via <code>spring.thymeleaf.*</code>, e.g.

<ul>
<li><code>spring.thymeleaf.prefix:classpath:/templates/</code> (location of templates)</li>
<li><code>spring.thymeleaf.cache:true</code> (set to <code>false</code> to reload templates
when changed)</li>
</ul></li>
<li>Extend and override, just add beans:

<ul>
<li>Thymeleaf <code>IDialect</code></li>
<li><code>thymeleafViewResolver</code></li>
<li><code>SpringTemplateEngine</code></li>
<li><code>defaultTemplateResolver</code></li>
</ul></li>
</ul>

</div><div class="slide" id="slide35"><h2 id="toc_33">Currently Available Autoconfigured Behaviour</h2>

<ul>
<li>Embedded servlet container (Tomcat or Jetty)</li>
<li>JDBC: <code>DataSource</code> and <code>JdbcTemplate</code></li>
<li>JPA, JMS, AMQP (Rabbit), AOP</li>
<li>Websocket</li>
<li>Spring Data JPA (scan for repositories) and Mongodb</li>
<li>Thymeleaf</li>
<li>Mobile</li>
<li>Batch processing</li>
<li>Reactor for events and async processing</li>
<li>Actuator features (Security, Audit, Metrics, Trace)</li>
</ul>

<p><em>Please open an issue on github if you want support for something else</em></p>

</div><div class="slide" id="slide36"><h2 id="toc_34">The Actuator</h2>

<p>Adds common non-functional features to your application and exposes
MVC endpoints to interact with them.</p>

<ul>
<li>Security</li>
<li>Secure endpoints: <code>/metrics</code>, <code>/health</code>, <code>/trace</code>, <code>/dump</code>, <code>/shutdown</code>, <code>/beans</code>, <code>/env</code></li>
<li><code>/info</code></li>
<li>Audit</li>
</ul>

<p>If embedded in a web app or web service can use the same port or a
different one (<code>management.port</code>) and/or a different network interface
(<code>management.address</code>) and/or context path (<code>management.context_path</code>).</p>

</div><div class="slide" id="slide37"><h2 id="toc_35">Adding Security</h2>

<ul>
<li>Use the Actuator</li>
<li>Add Spring Security to classpath, e.g. with <code>spring-boot-starter-security</code></li>
<li>Application endpoints secured via <code>security.basic.enabled=true</code> (on by default)</li>
<li>Management endpoints secure unless individually excluded</li>
</ul>

</div><div class="slide" id="slide38"><h2 id="toc_36">Adding a Remote SSH Server</h2>

<ul>
<li>Use the Actuator</li>
<li>Add <code>spring-boot-starter-shell-remote</code> to classpath</li>
<li>Application exposed to SSH on port 2000 by default</li>
</ul>

</div><div class="slide" id="slide39"><h2 id="toc_37">Building a WAR</h2>

<p>We like launchable JARs, but you can still use WAR format if you
prefer. Spring Boot Tools take care of repackaging a WAR to make it
executable.</p>

<p>If you want a WAR to be deployable (in a &quot;normal&quot; container), then you
need to use <code>SpringBootServletInitializer</code> instead of or as well as
<code>SpringApplication</code>.</p>

</div><div class="slide" id="slide40"><h2 id="toc_38">Customizing Business Content</h2>

<p><i class="icon-comment-alt icon-2x" style="color: #267b42"></i> Remember, it&#39;s just Spring...</p>

<ul>
<li>Add <code>@Bean</code> definitions</li>
<li>Use <code>@Autowired</code>, <code>@Value</code> and <code>@ComponentScan</code></li>
<li>Groovy CLI auto-imports common DI annotations</li>
<li>Even use old-fashioned XML if you like</li>
</ul>

</div><div class="slide" id="slide41"><h2 id="toc_39">Customizing the ApplicationContext</h2>

<ul>
<li>Directly on the <code>SpringApplication</code> instance (<code>spring.main.*</code>)</li>
<li>Add external configuration (System properties, OS env vars, config
file, command line arguments)</li>
<li>Add <code>SpringApplicationInitializer</code> implementations and enable in
<code>META-INF/spring.factories</code></li>
</ul>

</div><div class="slide" id="slide42"><h2 id="toc_40">Customizing @EnableAutoConfiguration</h2>

<ul>
<li>Disable specific feature <code>@EnableAutoConfiguration(disable={WebMvcAutoConfiguration.class})</code></li>
<li>Write you own...

<ul>
<li>Add JAR with <code>META-INF/spring.factories</code> entry for <code>EnableAutoConfiguration</code></li>
<li>All entries from classpath merged and added to context</li>
</ul></li>
</ul>

</div><div class="slide" id="slide43"><h2 id="toc_41">Customizing the CLI</h2>

<p>Uses standard Java <code>META-INF/services</code> scanning</p>

<ul>
<li><code>CompilerAutoConfiguration</code>: add dependencies and imports</li>
<li><code>CommandFactory</code>: add commands via a custom <code>CommandFactory</code> in <code>META-INF/services</code></li>
</ul>

<p>E.g. can add script commands (written in Groovy)</p>
<div class="highlight"><pre><code class="sh language-sh" data-lang="sh"><span class="nv">$ </span>spring foo ...
</code></pre></div>
<p>Looks for <code>foo.groovy</code> in <code>${SPRING_HOME}/bin</code> and
<code>${SPRING_HOME}/ext</code> by default</p>

</div><div class="slide" id="slide44"><h2 id="toc_42">Customizing Servlet Container Properties</h2>

<ul>
<li>Some common features exposed with external configuration,
e.g. <code>server.port</code> (see <code>ServerProperties</code> bean)</li>
<li>Add bean of type <code>EmbeddedServletContainerCustomizer</code> - all
instances get a callback</li>
<li>Add bean of type <code>EmbeddedServletContainerFactory</code> (replacing
auto-configured one)</li>
</ul>

</div><div class="slide" id="slide45"><h2 id="toc_43">Spring Boot Loader</h2>

<p><strong>Motivation</strong>: existing solutions for executable JAR are not very robust;
executable WAR is very tricky to create.</p>

<p><strong>Response</strong>: <code>JarLauncher</code> and <code>WarLauncher</code> with specialized
<code>ClassLoader</code> and <code>JarFile</code> implementations that can find resources in 
nested JARs (e.g. <code>lib/*.jar</code> or <code>WEB-INF/lib/*.jar</code>)</p>

</div><div class="slide" id="slide46"><h2 id="toc_44">How We Load Nested Jars</h2>

<p>Each regular JAR file is sequence of <code>JarEntries</code></p>

<p><code>yourapp.original.jar</code></p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">+----+----+----+-------
| A1 | A2 | A3 | ...
+----+----+----+-----
</code></pre></div>
<p><code>spring-core.jar</code></p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">+----+----+----+-------
| S1 | S2 | S3 | ...
+----+----+----+-----
</code></pre></div>
</div><div class="slide" id="slide47"><h2 id="toc_45">How We Load Nested Jars</h2>

<p>With nested JARs entries are contained within entries.</p>

<p><code>yourapp.jar</code></p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">+----+----+----+-+-------------------------
|    |    |    | +----+----+----+-------
| A1 | A2 | A3 | | S1 | S2 | S3 | ...
|    |    |    | +----+----+----+-------
+----+----+----+-+--------------------
</code></pre></div>
</div><div class="slide" id="slide48"><h2 id="toc_46">How We Load Nested Jars</h2>

<p>We can scan nested JARs and simply seek to the correct part of the outer file
when reading a nested entry.</p>

<p><code>yourapp.jar</code></p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">+----+----+----+-+-------------------------
|    |    |    | +----+----+----+-------
| A1 | A2 | A3 | | S1 | S2 | S3 | ...
|    |    |    | +----+----+----+-------
+----+----+----+-+--------------------
^    ^    ^      ^    ^    ^
</code></pre></div>
<blockquote>
<p><strong>NOTE:</strong> In order to seek inside the nested JAR, the containing entry cannot be compressed.</p>
</blockquote>

</div><div class="slide" id="slide49"><h2 id="toc_47">Spring Boot Loader Limitations</h2>

<ul>
<li>No compression for top-level JAR entries</li>
<li>Don&#39;t create nested JAR resource from String without context
<code>jar:file:/file.jar!/nested.jar!/a/b.txt</code></li>
<li>Use Spring abstractions for <code>Resource</code> wherever possible</li>
<li>Always use the context class loader (<code>ClassLoader.getSystemClassLoader()</code> will fail)</li>
</ul>

<blockquote>
<p>You don&#39;t need to use it, consider shade or a classic WAR</p>
</blockquote>

</div><div class="slide" id="slide50"><h2 id="toc_48">Testing with Spring Test (and MVC)</h2>

<p><code>SpringApplication</code> is an opinionated creator of an
<code>ApplicationContext</code>, but most of the behaviour is encapsulated in
<code>ApplicationContextInitializer</code> implementations. To reproduce the
behaviour of your app in an integration test it is useful to duplicate
those features, so you can use the corresponding initializers, or you
can use a context loader provided by Spring Boot.</p>

<p>Example with externalized configuration:</p>
<div class="highlight"><pre><code class="java language-java" data-lang="java"><span class="nd">@RunWith</span><span class="o">(</span><span class="n">SpringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">classes</span> <span class="o">=</span> <span class="n">IntegrationTestsConfiguration</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> 
    <span class="n">loader</span> <span class="o">=</span> <span class="n">SpringApplicationContextLoader</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IntegrationTests</span> <span class="o">{</span>

  <span class="c1">// Normal Spring Test stuff</span>

<span class="o">}</span>
</code></pre></div>
<blockquote>
<p>Hint: use <code>spring-boot-starter-test</code></p>
</blockquote>

</div><div class="slide" id="slide51"><h2 id="toc_49">Links</h2>

<ul>
<li><a href="http://projects.spring.io/spring-boot">http://projects.spring.io/spring-boot</a> Documentation</li>
<li><a href="https://github.com/spring-projects/spring-boot">https://github.com/spring-projects/spring-boot</a> Spring Boot on Github</li>
<li><a href="http://spring.io/blog">http://spring.io/blog</a></li>
<li><a href="http://presos.dsyer.com/decks/spring-boot-intro.html">http://dsyer.com/presos/decks/spring-boot-intro.html</a></li>
<li>Twitter: <code>@david_syer</code>, <code>@phillip_webb</code> </li>
<li>Email: <a href="mailto:dsyer@gopivotal.com">dsyer@gopivotal.com</a>, <a href="mailto:pwebb@gopivotal.com">pwebb@gopivotal.com</a></li>
</ul>

</div><div class="slide" id="slide52"><h2></h2>

<div id="center">
<div><i class="icon-smile icon-4x"></i> Spring Boot Intro - END <i class="icon-off icon-rotate-90 icon-4x"></i></div>
</div>
</div>


<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<p id="footer" class="deck-status">
	<span class="deck-status-current"></span>/<span class="deck-status-total"></span>
</p>

<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="number" name="slidenum" id="goto-slide">
	<input type="submit" value="Go">
</form>

<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.js"></script>
<script>window.jQuery || document.write('<script src="../deck.js/jquery.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="../deck.js/core/deck.core.js"></script>
<script src="../deck.js/extensions/menu/deck.menu.js"></script>
<script src="../deck.js/extensions/goto/deck.goto.js"></script>
<script src="../deck.js/extensions/status/deck.status.js"></script>
<script src="../deck.js/extensions/navigation/deck.navigation.js"></script>
<script src="../deck.js/extensions/hash/deck.hash.js"></script>

<script type="text/javascript">
$(function() {
	// Deck initialization
	$.deck('.slide');
	
	$('#style-themes').change(function() {
		$('#style-theme-link').attr('href', $(this).val());
	});
	
	$('#transition-themes').change(function() {
		$('#transition-theme-link').attr('href', $(this).val());
	});

    $('pre').click(function (){
	$(this).toggleClass('highlighted');
    });
});
</script>

</body>
</html>
