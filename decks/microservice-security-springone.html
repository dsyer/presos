<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title></title>
	
	<meta name="description" content="A jQuery library for modern HTML presentations">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="../deck.js/core/deck.core.css">
	<link rel="stylesheet" href="../deck.js/extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="../deck.js/extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="../deck.js/extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="../deck.js/extensions/status/deck.status.css">
	<link rel="stylesheet" href="../deck.js/extensions/hash/deck.hash.css">
	<link rel="stylesheet" href="../css/syntax.css">
	
	<!-- Theme CSS files (menu swaps these out) -->
    <link rel="stylesheet" href="../font-awesome/css/font-awesome.css">
    
    
	<link rel="stylesheet" id="style-theme-link" href="../themes/style/springone14.css">
	<link rel="stylesheet" id="transition-theme-link" href="../deck.js/themes/transition/horizontal-slide.css">
	
	<script src="../deck.js/modernizr.custom.js"></script>
</head>

<body class="deck-container">

<div class="slide" id="slide1"><h1 id="toc_0">Security for Microservices with Spring</h1>

<p>Dave Syer, 2012<br>
Twitter: @david_syer<br>
Email: <a href="mailto:dsyer@pivotal.io">dsyer@pivotal.io</a></p>

<p>(Security for Microservices with Spring)</p>

</div><div class="slide" id="slide2"><h2 id="toc_1">Agenda</h2>

<ul>
<li>What is a Microservice?</li>
<li>How would it be secure?</li>
<li>If I was going to use Spring how would that look?</li>
<li>What&#39;s the easiest way to get something working?</li>
</ul>

</div><div class="slide" id="slide3"><h2 id="toc_2">Introduction</h2>

<ul>
<li>There is a <a href="http://www.indeed.com/jobtrends?q=JSON+REST%2CSOAP+XML&amp;l=&amp;relative=1#shareCode">strong trend</a> in distributed systems with
lightweight architectures</li>
<li>People have started to call them &quot;microservices&quot;</li>
</ul>

<p><img src="images/jobgraph_REST_SOAP_2014.png" alt="job-trends"></p>

<ul>
<li>So what are people doing about security in such systems?</li>
</ul>

</div><div class="slide" id="slide4"><h2 id="toc_3">What is a Microservice?</h2>

<ul>
<li>HTTP transport (usually).</li>
<li>Text-based message content, usually <a href="http://en.wikipedia.org/wiki/JSON">JSON</a>.</li>
<li>Small, compact messages, and quick responses.</li>
<li>REST-ful, or at least inspired by the <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST</a></li>
<li>Some degree of statelessness</li>
<li>Interoperability.</li>
</ul>

</div><div class="slide" id="slide5"><h2 id="toc_4">What Are the Security Requirements</h2>

<blockquote>
<p>Stop bad guys from accessing your resources</p>
</blockquote>

<p>Identity and permissions:</p>

<ul>
<li>How is identity and permission information conveyed to a service?</li>
<li>How is it decoded and interpreted?</li>
<li>What data are needed to make the access decision (user accounts,
roles, ACLs etc.)?</li>
<li>How is the data managed: who is responsible for storing and
retrieving it?</li>
<li>How can you verify that the request hasn&#39;t been tampered with?</li>
</ul>

</div><div class="slide" id="slide6"><h2 id="toc_5">HTTP Basic Authentication</h2>

<ul>
<li>Something of a lowest common denominator</li>
<li>Supported on practically all servers natively and out of the box</li>
<li>Ubiquitous support on the client side in all languages</li>
<li>Good support in Spring Security</li>
<li>Spring Boot autoconfigures it out of the box</li>
</ul>

<p>Example:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">    $ curl &quot;https://$username:$password@myhost/resource&quot;
</code></pre></div>
</div><div class="slide" id="slide7"><h2 id="toc_6">Simple Service</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@Grab</span><span class="o">(</span><span class="s1">&#39;spring-boot-starter-security&#39;</span><span class="o">)</span>
<span class="nd">@RestController</span>
<span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

   <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s2">&quot;/&quot;</span><span class="o">)</span>
   <span class="kt">def</span> <span class="nf">home</span><span class="o">()</span> <span class="o">{</span>
      <span class="o">[</span><span class="nl">status:</span> <span class="s1">&#39;OK&#39;</span><span class="o">]</span>
   <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide8"><h2 id="toc_7">So what&#39;s wrong with that?</h2>

<ul>
<li>Nothing, but...</li>
<li>Where do you get the credentials (the username and password)?</li>
<li>Fine for systems where all participants can share secrets securely</li>
<li>In practice that means small systems</li>
<li>Only supports username/password</li>
<li>Only covers authentication</li>
<li>No distinction between users and machines</li>
</ul>

</div><div class="slide" id="slide9"><h2 id="toc_8">Network Security</h2>

<ul>
<li>Microservice endpoints not visible outside an internal network</li>
<li>Very secure</li>
<li>Very flexible (e.g. using virtual networks)</li>
<li>Suits architecture based on &quot;edge&quot; server</li>
</ul>

</div><div class="slide" id="slide10"><h2 id="toc_9">So what&#39;s wrong with that?</h2>

<ul>
<li>Nothing, but...</li>
<li>Annoying to debug and a little bit fiddly to maintain</li>
<li>Configuration is out of the control of developers in many cases for
organizational reasons</li>
<li>There&#39;s no identity or authentication</li>
</ul>

</div><div class="slide" id="slide11"><h2 id="toc_10">Certificate Based Security</h2>

<ul>
<li>Set up SSL on server so that request has to contain certificate</li>
<li>Spring Security (X.509) can turn that into an <code>Authentication</code></li>
<li>If SSL is in the service layer (i.e. not at the router/loadbalancer)
then you have a keystore anyway</li>
</ul>

<p>Example:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$ curl -k --cert rod.pem:password https://localhost:8443/hello
</code></pre></div>
</div><div class="slide" id="slide12"><h2 id="toc_11">So what&#39;s wrong with that?</h2>

<ul>
<li>Nothing, but...</li>
<li>There&#39;s no user identity (only at most the machine) unless browsers
have certificates installed</li>
<li>Requires keystores and certificates in all applications and services
(significantly non-trivial if done properly, but some organizations
require it anyway)</li>
<li>No fine distinction between users and machines</li>
</ul>

</div><div class="slide" id="slide13"><h2 id="toc_12">Custom Authentication Token</h2>

<ul>
<li>Random identifier per authentication</li>
<li>Grant them from a central service and/or store in a central database</li>
<li>Can be exposed directly via developer UI</li>
<li>Re-hydrate authentication in service</li>
<li>Spring Security <code>AbstractPreAuthenticatedProcessingFilter</code> and friends</li>
<li>Even easier: Spring Session identifier</li>
<li>Github example: token is temporary password in HTTP Basic</li>
</ul>

</div><div class="slide" id="slide14"><h2 id="toc_13">So what&#39;s wrong with that?</h2>

<ul>
<li>Nothing, but...</li>
<li>No separation of client app from user authentication</li>
<li>Coarse grained authorization (all tokens activate all resources)</li>
<li>It&#39;s not a &quot;standard&quot; (but there are ready made implementations)</li>
<li>For user authentication, need to collect user credentials in app</li>
</ul>

</div><div class="slide" id="slide15"><h2 id="toc_14">OAuth2 Key Features</h2>

<ul>
<li>Extremely simple for clients</li>
<li>Access tokens carry information (beyond identity)</li>
<li>Resources are free to interpret token content</li>
</ul>

</div><div class="slide" id="slide16"><h2 id="toc_15">So what&#39;s wrong with that?</h2>

<ul>
<li>Nothing, but...</li>
<li>No standard (yet) for request signing</li>
</ul>

</div><div class="slide" id="slide17"><h2 id="toc_16">Quick Introduction to OAuth2</h2>

<blockquote>
<p>A Client application, often web application, acts on behalf of a
User, but with the User&#39;s approval</p>
</blockquote>

<ul>
<li>Authorization Server</li>
<li>Resource Server</li>
<li>Client application</li>
</ul>

<p>Common examples of Authorization Servers and Resource Servers on the internet:</p>

<ul>
<li><a href="http://developers.facebook.com">Facebook</a> - Graph API</li>
<li><a href="http://code.google.com/apis/accounts/docs/OAuth2.html">Google</a> - Google APIs</li>
<li><a href="http://uaa.cloudfoundry.com">Cloud Foundry</a> - Cloud Controller</li>
</ul>

</div><div class="slide" id="slide18"><h2 id="toc_17">OAuth2 Bearer Tokens</h2>

<p>Centralizing account management and permissions:</p>

<ul>
<li>OAuth 2.0 adds an extra dimension - more information for the access
decision</li>
<li>Standards always help in security</li>
<li>Lightweight - easy to <code>curl</code></li>
<li>Requires HTTPS for secure operation, but you can test with HTTP</li>
</ul>

</div><div class="slide" id="slide19"><h2 id="toc_18">OAuth2 and the Microservice</h2>

<p>Example command line Client:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">$ curl -H &quot;Authorization: Bearer $TOKEN&quot; https://myhost/resource
</code></pre></div>
<ul>
<li><code>https://myhost</code> is a Resource Server</li>
<li><code>TOKEN</code> is a Bearer Token</li>
<li>it came from an Authorization Server</li>
</ul>

</div><div class="slide" id="slide20"><h2 id="toc_19">Simple Authorization Server</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableAuthorizationServer</span>
<span class="kd">class</span> <span class="nc">AuthorizationServer</span> <span class="kd">extends</span> <span class="n">AuthorizationServerConfigurerAdapter</span> <span class="o">{</span>

   <span class="nd">@Override</span>
   <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">ClientDetailsServiceConfigurer</span> <span class="n">clients</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
      <span class="n">clients</span><span class="o">.</span><span class="na">inMemory</span><span class="o">()</span>
         <span class="o">.</span><span class="na">withClient</span><span class="o">(</span><span class="s2">&quot;my-client-with-secret&quot;</span><span class="o">)...</span>
   <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide21"><h2 id="toc_20">Example token contents</h2>

<ul>
<li>Client id</li>
<li>Resource id (audience)</li>
<li>Issuer</li>
<li>User id</li>
<li>Role assignments</li>
</ul>

</div><div class="slide" id="slide22"><h2 id="toc_21">JWT Bearer Tokens</h2>

<ul>
<li>OAuth 2.0 tokens are opaque to clients</li>
<li>But they carry important information to Resource Servers</li>
<li><p>Example of implementation (from Cloud Foundry UAA, JWT = signed,
base64-encoded, JSON):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">{  &quot;client_id&quot;:&quot;cf&quot;,
   &quot;exp&quot;:1346325625,
   &quot;scope&quot;:[&quot;cloud_controller.read&quot;,&quot;openid&quot;,&quot;password.write&quot;],
   &quot;aud&quot;:[&quot;openid&quot;,&quot;cloud_controller&quot;,&quot;password&quot;],
   &quot;iss&quot;: &quot;https://login.run.pivotal.io&quot;,
   &quot;user_name&quot;:&quot;tester@vmware.com&quot;,
   &quot;user_id&quot;:&quot;52147673-9d60-4674-a6d9-225b94d7a64e&quot;,
   &quot;email&quot;:&quot;tester@vmware.com&quot;,
   &quot;jti&quot;:&quot;f724ae9a-7c6f-41f2-9c4a-526cea84e614&quot; }
</code></pre></div></li>
</ul>

</div><div class="slide" id="slide23"><h2 id="toc_22">JWT Authorization Server</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableAuthorizationServer</span>
<span class="kd">class</span> <span class="nc">AuthorizationServer</span> <span class="kd">extends</span> <span class="n">AuthorizationServerConfigurerAdapter</span> <span class="o">{</span>

   <span class="nd">@Bean</span>
   <span class="kd">public</span> <span class="n">JwtAccessTokenConverter</span> <span class="nf">accessTokenConverter</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">JwtAccessTokenConverter</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthorizationServerEndpointsConfigurer</span> <span class="n">endpoints</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
      <span class="n">endpoints</span><span class="o">.</span><span class="na">authenticationManager</span><span class="o">(</span><span class="n">authenticationManager</span><span class="o">)</span>
         <span class="o">.</span><span class="na">accessTokenConverter</span><span class="o">(</span><span class="n">accessTokenConverter</span><span class="o">());</span>
   <span class="o">}</span>

   <span class="o">...</span> <span class="c1">// client config</span>
<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide24"><h2 id="toc_23">User Approvals</h2>

<p>An access token represents a user approval:</p>

<p><img src="images/token-model.png" alt="token-model"></p>

</div><div class="slide" id="slide25"><h2 id="toc_24">User Approvals as Token</h2>

<p>An access token represents a user approval:</p>

<p><img src="images/token-as-approval.png" alt="token-as-approval"></p>

</div><div class="slide" id="slide26"><h2 id="toc_25">Formal Model for User Approvals</h2>

<p>It can be an advantage to store individual approvals independently
(e.g. for explicit revokes of individual scopes):</p>

<p><img src="images/token-with-approvals.png" alt=""></p>

</div><div class="slide" id="slide27"><h2 id="toc_26">Spring OAuth Support</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableAuthorizationServer</span>
<span class="kd">class</span> <span class="nc">AuthorizationServer</span> <span class="kd">extends</span> <span class="n">AuthorizationServerConfigurerAdapter</span> <span class="o">{</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthorizationServerEndpointsConfigurer</span> <span class="n">endpoints</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
            <span class="n">endpoints</span><span class="o">.</span><span class="na">tokenStore</span><span class="o">(</span><span class="n">tokenStore</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="nd">@Bean</span>
        <span class="kd">public</span> <span class="n">ApprovalStore</span> <span class="nf">approvalStore</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
            <span class="n">TokenApprovalStore</span> <span class="n">store</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TokenApprovalStore</span><span class="o">();</span>
            <span class="n">store</span><span class="o">.</span><span class="na">setTokenStore</span><span class="o">(</span><span class="n">tokenStore</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">store</span><span class="o">;</span>
        <span class="o">}</span>

   <span class="o">...</span> <span class="c1">// client config and tokenStore() defined here</span>
<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide28"><h2 id="toc_27">Simple Resource Server</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableResourceServer</span>
<span class="kd">class</span> <span class="nc">ResourceServer</span> <span class="o">{</span>
   <span class="nd">@Bean</span>
   <span class="n">TokenStore</span> <span class="nf">tokenStore</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
      <span class="o">...</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableResourceServer</span>
<span class="kd">class</span> <span class="nc">ResourceServer</span> <span class="o">{</span>
   <span class="nd">@Bean</span>
   <span class="n">ResourceServerTokenServices</span> <span class="nf">tokenServices</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
      <span class="o">...</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide29"><h2 id="toc_28">Simple Client Application</h2>
<div class="highlight"><pre><code class="groovy language-groovy" data-lang="groovy"><span class="nd">@EnableOAuth2Client</span>
<span class="kd">class</span> <span class="nc">ClientApplication</span> <span class="o">{</span>

   <span class="nd">@Autowired</span> <span class="c1">// session-scoped</span>
   <span class="kd">private</span> <span class="n">OAuth2ClientContext</span> <span class="n">clientContext</span>

   <span class="nd">@Bean</span>
   <span class="n">OAuth2RestOperations</span> <span class="nf">restTemplate</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">new</span> <span class="nf">OAuth2RestTemplate</span><span class="o">(</span><span class="n">resource</span><span class="o">,</span> <span class="n">clientContext</span><span class="o">)</span>
   <span class="o">}</span>

   <span class="o">...</span>

<span class="o">}</span>
</code></pre></div>
</div><div class="slide" id="slide30"><h2 id="toc_29">Authorization Code Grant Summary</h2>

<ol>
<li><p>Authorization Server authenticates the User</p></li>
<li><p>Client starts the authorization flow and obtain User&#39;s approval</p></li>
<li><p>Authorization Server issues an authorization code (opaque one-time
token)</p></li>
<li><p>Client exchanges the authorization code for an access token.</p></li>
</ol>

</div><div class="slide" id="slide31"><h2 id="toc_30">Role of Resource Server</h2>

<ol>
<li>Extract token from request and decode it</li>
<li>Make access control decision

<ul>
<li>Scope</li>
<li>Audience</li>
<li>User account information (id, roles etc.)</li>
<li>Client information (id, roles etc.)</li>
</ul></li>
<li>Send 403 (FORBIDDEN) if token not sufficient</li>
</ol>

</div><div class="slide" id="slide32"><h2 id="toc_31">Role of the Authorization Server</h2>

<ol>
<li>Grant tokens</li>
<li>Interface for users to confirm that they authorize the Client to act
on their behalf</li>
<li>Authenticate users (<code>/authorize</code>)</li>
<li>Authenticate clients (<code>/token</code>)</li>
</ol>

<p>#1 and #4 are covered thoroughly by the spec; #2 and #3 not (for
good reasons).</p>

</div><div class="slide" id="slide33"><h2 id="toc_32">Client Registration and Scopes</h2>

<p>For secure channels a client has to authenticate itself to obtain a
token, so it has to be known to the Authorization Server.
Registration provides at a mimimum:</p>

<ul>
<li>authentication (shared secret)</li>
<li>registered redirect URI (optional but essential to prevent attacks)</li>
<li>allowed scopes (clients are not permitted access to all resources)</li>
</ul>

<p>Also useful:</p>

<ul>
<li>a way to identify which resources can be accessed</li>
<li>ownership information (which user registered the client)</li>
</ul>

</div><div class="slide" id="slide34"><h2 id="toc_33">More on Scopes</h2>

<p>Per the spec they are arbitrary strings.  The Authorization Server and
the Resource Servers agree on the content and meanings.</p>

<p>Examples:</p>

<ul>
<li>Google: <code>https://www.googleapis.com/auth/userinfo.profile</code></li>
<li>Facebook: <code>email</code>, <code>read_stream</code>, <code>write_stream</code></li>
<li>UAA: <code>cloud_controller.read</code>, <code>cloud_controller.write</code>, <code>scim.read</code>,
<code>openid</code></li>
</ul>

<p>Authorization Server has to decide whether to grant a token to a given
client and user based on the requested scope (if any).</p>

</div><div class="slide" id="slide35"><h2 id="toc_34">Authentication and the Authorization Server</h2>

<ul>
<li>Authentication (checking user credentials) is orthogonal to
authorization (granting tokens)</li>
<li>They don&#39;t have to be handled in the same component of a large
system</li>
<li>Authentication is often deferred to existing systems (SSO)</li>
<li>Authorization Server has to be able to authenticate the OAuth
endpoints (<code>/authorize</code> and <code>/token</code>)</li>
<li>It <em>does not</em> have to collect credentials (except for
<code>grant_type=password</code>)</li>
</ul>

</div><div class="slide" id="slide36"><h2 id="toc_35">OAuth2 and the Microservice</h2>

<ul>
<li>Resource Servers might be microservices</li>
<li>Web app clients: authorization code grant</li>
<li>Browser clients (single page app): authorization code grant (better) or implicit grant</li>
<li>Mobile and non-browser clients: password grant (maybe with mods for multifactor etc.)</li>
<li>Service clients (intra-system): client credentials or relay user token</li>
</ul>

</div><div class="slide" id="slide37"><h2 id="toc_36">Single Page Apps</h2>

<p>With backend services CORS restrictions make reverse proxy useful (<code>@EnableZuulProxy</code>).
Then you can acquire tokens in the client app and relay them to back end.</p>

<p>With no backend services, don&#39;t be shy, <strong>use the session</strong> (authorization code flow is vastly
superior).</p>

<p>Spring Session helps a lot.</p>

</div><div class="slide" id="slide38"><h2 id="toc_37">Relaying User Tokens</h2>

<blockquote>
<p>Front end app sends SSO token with user credentials to authenticate
back end requests, back ends just relay it to each other as
necessary.</p>
</blockquote>

<p>Simple but possibly flawed: the front end only needs access to user
details to authenticate, but you need to give it permission to do
other things to allow it access to the back ends.</p>

<p>Idea: exchange (with full authentication) the incoming token for an
outgoing one with different permissions (client but not scope). Can
use password grant (e.g. with the incoming token as a password).</p>

</div><div class="slide" id="slide39"><h2 id="toc_38">OAuth 1.0</h2>

<ul>
<li>Another (slightly older) standard</li>
<li>Includes request signing</li>
<li>Common in early wave public APIs (e.g. Twitter)</li>
<li>Spring Security OAuth is full solution at framework level</li>
</ul>

</div><div class="slide" id="slide40"><h2 id="toc_39">So What&#39;s Wrong with That?</h2>

<p>Nothing but...</p>

<ul>
<li>It&#39;s hard work for client app developers (crypto)</li>
<li>(Notionally at least) superseded by OAuth2</li>
</ul>

</div><div class="slide" id="slide41"><h2 id="toc_40">SAML Assertions</h2>

<ul>
<li>Another standard with similar features to OAuth2</li>
<li>XML based</li>
<li>Common infrastructure in enterprise</li>
<li>Spring Security SAML provides SP and Consumer roles (not IDP)</li>
<li>Request signing is standadized</li>
</ul>

</div><div class="slide" id="slide42"><h2 id="toc_41">So What&#39;s Wrong with That?</h2>

<p>Nothing but...</p>

<ul>
<li>Painful to set up for servers and client</li>
<li>Large amounts of XML data in HTTP headers</li>
<li>Huge complexity for developers</li>
</ul>

<p>N.B. exchanging SAML assertion for OAuth2 token is quote normal</p>

</div><div class="slide" id="slide43"><h2 id="toc_42">In Conclusion</h2>

<ul>
<li>Lightweight services demand lightweight infrastructure</li>
<li>Security is important, but should be unobtrusive</li>
<li>Spring Security makes it all easier</li>
<li>Special mention for Spring Session</li>
<li>OAuth 2.0 is a standard, and has a lot of useful features</li>
<li><a href="http://github.com/springsource/spring-security-oauth">Spring Security OAuth</a> aims to be a complete OAuth2
solution at the framework level</li>
<li>Cloudfoundry has an open source, OAuth2 identity service (UAA)</li>
</ul>

</div><div class="slide" id="slide44"><h2 id="toc_43">Links</h2>

<ul>
<li><a href="http://github.com/spring-projects/spring-security-oauth">http://github.com/spring-projects/spring-security-oauth</a></li>
<li><a href="http://github.com/spring-projects/spring-security-oauth/tree/master/tests/annotation">http://github.com/spring-projects/spring-security-oauth/tree/master/tests/annotation</a></li>
<li><a href="http://github.com/cloudfoundry/uaa">http://github.com/cloudfoundry/uaa</a></li>
<li><a href="http://blog.spring.io">http://blog.spring.io</a></li>
<li><a href="http://blog.cloudfoundry.org">http://blog.cloudfoundry.org</a></li>
<li><a href="http://presos.dsyer.com/decks/microservice-security.html">http://presos.dsyer.com/decks/microservice-security.html</a></li>
<li>Twitter: @david_syer<br></li>
<li>Email: <a href="mailto:dsyer@pivotal.io">dsyer@pivotal.io</a></li>
</ul>
</div>


<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<p id="footer" class="deck-status">
	<span class="deck-status-current"></span>/<span class="deck-status-total"></span>
</p>

<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="number" name="slidenum" id="goto-slide">
	<input type="submit" value="Go">
</form>

<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.js"></script>
<script>window.jQuery || document.write('<script src="../deck.js/jquery.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="../deck.js/core/deck.core.js"></script>
<script src="../deck.js/extensions/menu/deck.menu.js"></script>
<script src="../deck.js/extensions/goto/deck.goto.js"></script>
<script src="../deck.js/extensions/status/deck.status.js"></script>
<script src="../deck.js/extensions/navigation/deck.navigation.js"></script>
<script src="../deck.js/extensions/hash/deck.hash.js"></script>

<script type="text/javascript">
$(function() {
	// Deck initialization
	$.deck('.slide');
	
	$('#style-themes').change(function() {
		$('#style-theme-link').attr('href', $(this).val());
	});
	
	$('#transition-themes').change(function() {
		$('#transition-theme-link').attr('href', $(this).val());
	});

    $('pre').click(function (){
	$(this).toggleClass('highlighted');
    });
});
</script>

</body>
</html>
